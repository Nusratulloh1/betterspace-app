<template>
  <div class="bottomMenu">
    <!-- <h4 class="text-black">{{ qrResult }} sdsdf</h4> -->
    <div class="menus">
      <NuxtLink to="/">
        <svg width="28" height="30" viewBox="0 0 28 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M27.2367 13.894V26.9278C27.2367 27.5261 26.999 28.0998 26.576 28.5229C26.153 28.9459 25.5792 29.1835 24.9809 29.1835H19.3416C18.7434 29.1835 18.1696 28.9459 17.7466 28.5229C17.3236 28.0998 17.0859 27.5261 17.0859 26.9278V21.2885C17.0859 20.9894 16.9671 20.7025 16.7556 20.491C16.544 20.2795 16.2572 20.1606 15.958 20.1606H11.4466C11.1475 20.1606 10.8606 20.2795 10.6491 20.491C10.4376 20.7025 10.3187 20.9894 10.3187 21.2885V26.9278C10.3187 27.5261 10.0811 28.0998 9.65804 28.5229C9.23501 28.9459 8.66126 29.1835 8.06301 29.1835H2.42369C1.82544 29.1835 1.25169 28.9459 0.828655 28.5229C0.405625 28.0998 0.167969 27.5261 0.167969 26.9278V13.894C0.167921 13.5818 0.232679 13.273 0.358143 12.9871C0.483607 12.7012 0.667045 12.4445 0.89685 12.2332L12.1755 1.5918L12.191 1.57629C12.6062 1.19864 13.1474 0.98938 13.7087 0.98938C14.27 0.98938 14.8111 1.19864 15.2263 1.57629C15.2312 1.58181 15.2363 1.58699 15.2419 1.5918L26.5205 12.2332C26.748 12.4456 26.9291 12.7028 27.0523 12.9886C27.1756 13.2745 27.2383 13.5827 27.2367 13.894Z" />
        </svg>
        Home
      </NuxtLink>
      <a href="#" class="relative" @click="showQr">
        <svg class="!w-12 !h-12 absolute top-[-15px]" width="71" height="70" viewBox="0 0 71 70" fill="none"
          xmlns="http://www.w3.org/2000/svg">
          <g filter="url(#filter0_d_31_2775)">
            <rect x="4" y="2.00043" width="63" height="63" rx="31.5" fill="black" shape-rendering="crispEdges" />
            <path
              d="M31.6563 19.4067H23.9688C23.2891 19.4067 22.6374 19.6767 22.1568 20.1572C21.6762 20.6378 21.4063 21.2896 21.4062 21.9692V29.6567C21.4062 30.3363 21.6762 30.9881 22.1568 31.4686C22.6374 31.9492 23.2891 32.2192 23.9688 32.2192H31.6563C32.3359 32.2192 32.9876 31.9492 33.4682 31.4686C33.9488 30.9881 34.2188 30.3363 34.2188 29.6567V21.9692C34.2188 21.2896 33.9488 20.6378 33.4682 20.1572C32.9876 19.6767 32.3359 19.4067 31.6563 19.4067ZM31.6563 29.6567H23.9688V21.9692H31.6563V29.6567ZM31.6563 34.7817H23.9688C23.2891 34.7817 22.6374 35.0517 22.1568 35.5322C21.6762 36.0128 21.4063 36.6646 21.4062 37.3442V45.0317C21.4062 45.7113 21.6762 46.3631 22.1568 46.8436C22.6374 47.3242 23.2891 47.5942 23.9688 47.5942H31.6563C32.3359 47.5942 32.9876 47.3242 33.4682 46.8436C33.9488 46.3631 34.2188 45.7113 34.2188 45.0317V37.3442C34.2188 36.6646 33.9488 36.0128 33.4682 35.5322C32.9876 35.0517 32.3359 34.7817 31.6563 34.7817ZM31.6563 45.0317H23.9688V37.3442H31.6563V45.0317ZM47.0313 19.4067H39.3438C38.6641 19.4067 38.0124 19.6767 37.5318 20.1572C37.0512 20.6378 36.7813 21.2896 36.7813 21.9692V29.6567C36.7813 30.3363 37.0512 30.9881 37.5318 31.4686C38.0124 31.9492 38.6641 32.2192 39.3438 32.2192H47.0313C47.7109 32.2192 48.3627 31.9492 48.8432 31.4686C49.3238 30.9881 49.5938 30.3363 49.5938 29.6567V21.9692C49.5938 21.2896 49.3238 20.6378 48.8432 20.1572C48.3627 19.6767 47.7109 19.4067 47.0313 19.4067ZM47.0313 29.6567H39.3438V21.9692H47.0313V29.6567ZM36.7813 41.1879V36.0629C36.7813 35.7231 36.9162 35.3972 37.1565 35.1569C37.3968 34.9167 37.7227 34.7817 38.0625 34.7817C38.4023 34.7817 38.7282 34.9167 38.9685 35.1569C39.2088 35.3972 39.3438 35.7231 39.3438 36.0629V41.1879C39.3438 41.5277 39.2088 41.8536 38.9685 42.0939C38.7282 42.3342 38.4023 42.4692 38.0625 42.4692C37.7227 42.4692 37.3968 42.3342 37.1565 42.0939C36.9162 41.8536 36.7813 41.5277 36.7813 41.1879ZM49.5938 38.6254C49.5938 38.9652 49.4588 39.2911 49.2185 39.5314C48.9782 39.7717 48.6523 39.9067 48.3125 39.9067H44.4688V46.3129C44.4688 46.6527 44.3338 46.9786 44.0935 47.2189C43.8532 47.4592 43.5273 47.5942 43.1875 47.5942H38.0625C37.7227 47.5942 37.3968 47.4592 37.1565 47.2189C36.9162 46.9786 36.7813 46.6527 36.7813 46.3129C36.7813 45.9731 36.9162 45.6472 37.1565 45.4069C37.3968 45.1667 37.7227 45.0317 38.0625 45.0317H41.9063V36.0629C41.9063 35.7231 42.0412 35.3972 42.2815 35.1569C42.5218 34.9167 42.8477 34.7817 43.1875 34.7817C43.5273 34.7817 43.8532 34.9167 44.0935 35.1569C44.3338 35.3972 44.4688 35.7231 44.4688 36.0629V37.3442H48.3125C48.6523 37.3442 48.9782 37.4792 49.2185 37.7194C49.4588 37.9597 49.5938 38.2856 49.5938 38.6254ZM49.5938 43.7504V46.3129C49.5938 46.6527 49.4588 46.9786 49.2185 47.2189C48.9782 47.4592 48.6523 47.5942 48.3125 47.5942C47.9727 47.5942 47.6468 47.4592 47.4065 47.2189C47.1662 46.9786 47.0313 46.6527 47.0313 46.3129V43.7504C47.0313 43.4106 47.1662 43.0847 47.4065 42.8444C47.6468 42.6042 47.9727 42.4692 48.3125 42.4692C48.6523 42.4692 48.9782 42.6042 49.2185 42.8444C49.4588 43.0847 49.5938 43.4106 49.5938 43.7504Z"
              fill="white" />
          </g>
          <defs>
            <filter id="filter0_d_31_2775" x="0.85" y="0.425427" width="69.3" height="69.3" filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                result="hardAlpha" />
              <feOffset dy="1.575" />
              <feGaussianBlur stdDeviation="1.575" />
              <feComposite in2="hardAlpha" operator="out" />
              <feColorMatrix type="matrix" values="0 0 0 0 0.0627451 0 0 0 0 0.0941176 0 0 0 0 0.156863 0 0 0 0.05 0" />
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_31_2775" />
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_31_2775" result="shape" />
            </filter>
          </defs>
        </svg>
        <span class="mt-8"> Take a benefit </span>
      </a>
      <NuxtLink to="/expenses">
        <svg width="26" height="30" viewBox="0 0 26 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M13.0001 30C11.9038 30 10.8357 29.442 10.1049 28.4652L8.68543 26.5814C8.39029 26.1907 7.99679 25.9675 7.57516 25.9395C7.15354 25.9257 6.73192 26.107 6.39462 26.4559L5.59354 25.7442L6.3665 26.4559C4.34271 28.6047 2.78271 28.4373 2.03785 28.1443C1.27893 27.8513 0 26.8885 0 23.7908V8.07909C0 1.88372 1.79893 0 7.68759 0H18.3125C24.2011 0 26 1.88372 26 8.07909V23.7908C26 26.8745 24.7212 27.8373 23.9623 28.1443C23.2173 28.4373 21.6714 28.6047 19.6335 26.4559C19.2962 26.0931 18.8887 25.8977 18.439 25.9395C18.0174 25.9675 17.6097 26.1907 17.3146 26.5814L15.8952 28.4652C15.1643 29.442 14.0963 30 13.0001 30ZM7.49084 23.8326C7.54705 23.8326 7.61733 23.8326 7.67353 23.8326C8.71355 23.8884 9.69732 24.4325 10.3579 25.3116L11.7774 27.1953C12.4659 28.1024 13.52 28.1024 14.2087 27.1953L15.6281 25.3116C16.3027 24.4325 17.2724 23.8884 18.3265 23.8326C19.3666 23.7768 20.4065 24.2094 21.1654 25.0186C22.2336 26.1488 22.9363 26.2884 23.1751 26.1907C23.5124 26.0513 23.8779 25.2419 23.8779 23.7908V8.07909C23.8779 3.04186 22.9925 2.09303 18.2984 2.09303H7.68759C2.99352 2.09303 2.10811 3.04186 2.10811 8.07909V23.7908C2.10811 25.2559 2.47353 26.0651 2.81083 26.1907C3.04974 26.2884 3.75244 26.1488 4.82056 25.0186C5.57948 24.2513 6.52111 23.8326 7.49084 23.8326Z" />
          <path
            d="M18.8947 9H7.10527C6.50106 9 6 8.54668 6 8C6 7.45334 6.50106 7 7.10527 7H18.8947C19.4991 7 20 7.45334 20 8C20 8.54668 19.4991 9 18.8947 9Z" />
          <path
            d="M17 15H9C8.45334 15 8 14.5466 8 14C8 13.4533 8.45334 13 9 13H17C17.5466 13 18 13.4533 18 14C18 14.5466 17.5466 15 17 15Z" />
        </svg>

        Expenses
      </NuxtLink>
    </div>
  </div>
  <ScanQr v-if="showScan" @result="handleScanResult" />
  <Dialog v-model:visible="visibleModal" header=" " modal :style="{ width: '21rem' }">
    <successStartForm @submit="submitForm" />
  </Dialog>
</template>
<script lang="ts" setup>
import { ScanQr, useWebAppQrScanner } from "vue-tg";
import { computed, ref } from "vue";
import { useTgWebAppStore } from "~/store/tgWebApp";
import successStartForm from "~/components/forms/qrSuccessForm.vue";
const tgStore = useTgWebAppStore();
const WebAppQrScanner = useWebAppQrScanner()
const qrResult = computed(() => tgStore.qrResult);
const visibleModal = ref(false)
const showScan = ref(false);
const showQr = () => {
  showScan.value = true;
};
WebAppQrScanner.onScanQrPopupClosed((val: any) => {
  showScan.value = false;
  // visibleModal.value = true
})
const handleScanResult = async (res: any) => {
  tgStore.qrResult = res
  showScan.value = false;
  setTimeout(() => {
    visibleModal.value = true
  }, 1000);
};
const submitForm = (data: any) => {
  console.log(data);

}
</script>
<style lang="scss" scoped>
.bottomMenu {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  backdrop-filter: blur(22.5572509765625px);
  background: #ffffff;
  padding: 18px 22px 12px;

  .menus {
    display: flex;
    align-items: center;
    justify-content: space-between;

    a {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: Poppins;
      font-size: 14.05px;
      font-weight: 500;
      line-height: 17.07px;
      color: #8c8c8c;
      text-decoration: none;

      svg {
        width: 20px;
        height: 20px;
        fill: #525252;
        margin-bottom: 6px;
      }

      &.router-link-active {
        font-weight: 600;
        color: #272727 !important;

        svg {
          fill: #272727;
        }
      }
    }
  }
}
</style>